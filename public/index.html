<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wrestling Shoes, Gear & Apparel | Wrestle Swap</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <style>
        /* Page-specific styles for index.html */
        body {
            background-color: #ffffff;
        }

        .banner {
            background: url("https://www.pennsylvaniartc.org/static/sitefiles/news/News-Jul-2020-Jordan-Burroughs.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .logo {
            font-size: 32px;
        }
    </style>
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-content">
            <div>
                <!-- User Menu Container - This will be updated by JavaScript -->
                <span id="user-menu-wrapper">
                    <button class="top-bar-btn" id="user-greeting" onclick="window.location.href='sign-in.html'">Hi! Sign in</button>
                </span>
                <button class="top-bar-btn" onclick="window.location.href='help.html'">Help & Contact</button>
            </div>
            <div>
                <button class="top-bar-btn" onclick="window.location.href='sell.html'">Sell</button>
                <button class="top-bar-btn" onclick="window.location.href='settings.html'">Settings</button>
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <div class="main-header">
        <div class="header-content">
            <a href="index.html" class="logo">Wrestle Swap</a>
            <div class="search-container">
                <div class="search-box">
                    <input
                        type="text"
                        class="search-input"
                        id="search-input"
                        placeholder="Search for wrestling shoes, singlets, gear..."
                        onkeypress="if(event.key==='Enter') performSearch()"
                    >
                </div>
                <button class="search-btn" onclick="performSearch()">Search</button>
            </div>
            <button class="top-bar-btn" onclick="window.location.href='track.html'">Track <div></div>Packages</button>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav-bar">
        <div class="nav-content">
            <a href="watchlist.html">Saved</a>
            <a href="search.html">All Categories</a>
            <a href="search.html?q=shoes">Wrestling Shoes</a>
            <a href="search.html?q=singlet">Singlets</a>
            <a href="search.html?q=shirt">Shirts</a>
            <a href="search.html?q=shorts">Shorts</a>
            <a href="search.html?q=bags">Bags</a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Banner -->
        <div class="banner">
            <h1>Buy & Sell Wrestling Gear</h1>
            <p>Find quality wrestling equipment at great prices</p>
            <button class="banner-btn" onclick="window.location.href='search.html'">Shop Now</button>
        </div>

        <!-- Categories -->
        <h2 class="section-title">Explore Popular Categories</h2>
        <div class="categories">
            <div class="category-card" onclick="window.location.href='search.html?q=shoes'">
                <img src="https://cdn11.bigcommerce.com/s-ob1gxw6h/images/stencil/1280x1280/products/1815/16182/Untitled_design_60__78315.1727788914.png?c=20" alt="Wrestling Shoes" style="width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px;">
                <div class="category-name">Wrestling Shoes</div>
            </div>
            <div class="category-card" onclick="window.location.href='search.html?q=singlet'">
                <img src="https://www.wrestlingmart.com/cdn/shop/files/NIKEUSAWRESTLINGWOMENSCLOUDSINGLET-RED-QR.jpg?crop=center&height=1200&v=1744832852&width=1200" alt="Singlets" style="width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px;">
                <div class="category-name">Singlets</div>
            </div>
            <div class="category-card" onclick="window.location.href='search.html?q=Shirt'">
                <img src="https://images.footballfanatics.com/usa-wrestling/mens-heather-gray-usa-wrestling-radiating-victory-t-shirt_ss5_p-200582126+pv-1+u-qyxjpp1vyzbbqjic0ara+v-bntg3xaqmktnhj5tbivy.jpg?_hv=2&w=1018" alt="Shirts" style="width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px;">
                <div class="category-name">Shirts</div>
            </div>
            <div class="category-card" onclick="window.location.href='search.html?q=Shorts'">
                <img src="https://www.flowholdsd.com/cdn/shop/files/IMG_1427_jpg-min_720x.png?v=1698344274" alt="Shorts" style="width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px;">
                <div class="category-name">Shorts</div>
            </div>
            <div class="category-card" onclick="window.location.href='search.html?q=bags'">
                <img src="https://cliffkeen.com/cdn/shop/files/MBP13-WH_1.png?crop=center&height=1200&v=1709304359&width=1200" alt="Bags" style="width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px;">
                <div class="category-name">Bags</div>
            </div>
        </div>

        <!-- Products -->
        <h2 class="section-title">Today's Deals</h2>

        <div class="loading-products" id="loading-products">Loading products...</div>
        <div class="products" id="products-container"></div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <div class="footer-column">
                    <h3>Buyer and Seller</h3>
                    <a href="sign-in.html">Registration</a>
                    <a href="money-back.html">Swaps Money Back Guarantee</a>
                    <a href="shipping-instructions.html">Shipping my item</a>
                    <a href="track.html">Track Order</a>
                </div>
                <div class="footer-column">
                    <h3>About Wrestle Swap</h3>
                    <a href="about-us.html">About us</a>
                    <a href="careers.html">Careers</a>
                </div>
                <div class="footer-column">
                    <h3>Help & Contact</h3>
                    <a href="#">Seller Information Center</a>
                    <a href="help.html">Contact us</a>
                </div>
                <div class="footer-column">
                    <h3>Community</h3>
                    <a href="#">Announcements</a>
                    <a href="legal/disclaimer.html">Marketplace Disclaimer</a>
                    <a href="legal/assumption-of-risk.html">Assumption of Risk Clause</a>
                    <a href="legal/terms-of-service.html">Terms of Service</a>
                </div>
            </div>
            <footer style="background: #dad0d0; padding: 30px; text-align: center;">
                <div>
                    <a href="legal/privacy-policy.html" style="color: #333; margin: 0 15px;">Privacy Policy</a>
                    <a href="legal/cookie.html" style="color: #333; margin: 0 15px;">Cookie Policy</a>
                    <a href="legal/adchoice.html" style="color: #333; margin: 0 15px;">AdChoices</a>
                </div>
                <p style="margin-top: 15px; font-size: 12px; color: #666;">
                    Â© 2026 Wrestle Swap. All rights reserved.
                </p>
            </footer>
        </div>
    </div>

    <!-- Firebase SDK for User Greeting and Products -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBrNzOA__bI6zA2PvTFTujmFiBLsCe1iBk",
            authDomain: "wrestleswap.firebaseapp.com",
            projectId: "wrestleswap",
            storageBucket: "wrestleswap.firebasestorage.app",
            messagingSenderId: "857051782398",
            appId: "1:857051782398:web:bb4ab3f98e8dbbc8cad9af",
            measurementId: "G-B411WXLF3J"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Handle user greeting with dropdown for signed-in users
        onAuthStateChanged(auth, (user) => {
            const menuWrapper = document.getElementById('user-menu-wrapper');

            if (user) {
                // User is signed in - show dropdown menu
                const firstName = user.displayName ? user.displayName.split(' ')[0] : user.email.split('@')[0];

                // Create the dropdown menu HTML
                menuWrapper.innerHTML = `
                    <div class="user-menu-container">
                        <button class="top-bar-btn" onclick="window.location.href='profile.html'">Hi, ${firstName}!</button>
                        <div class="dropdown-menu">
                            <a href="watchlist.html">Watchlist</a>
                            <a href="my-orders.html">Your Orders</a>
                            <a href="listings-manager.html">Your Listings</a>
                        </div>
                    </div>
                `;
            } else {
                // User is not signed in - show simple sign-in button
                menuWrapper.innerHTML = `
                    <button class="top-bar-btn" onclick="window.location.href='sign-in.html'">Hi! Sign in</button>
                `;
            }
        });

        // Load products from Firestore
        async function loadProducts() {
            const container = document.getElementById('products-container');
            const loading = document.getElementById('loading-products');

            try {
                const q = query(
                    collection(db, 'products'),
                    where('active', '==', true),
                    limit(12)
                );

                const querySnapshot = await getDocs(q);
                const products = [];

                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    // Skip sold products
                    if (data.sold === true) return;

                    products.push({
                        id: doc.id,
                        title: data.title,
                        price: data.price || 0,
                        sellerName: data.sellerName || 'Unknown Seller',
                        images: data.images || [],
                        condition: data.condition || ''
                    });
                });

                loading.style.display = 'none';

                if (products.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #707070; padding: 40px;">No products available yet. Be the first to list!</p>';
                    return;
                }

                container.innerHTML = products.map(product => {
                    const imageDisplay = product.images && product.images.length > 0
                        ? `<img src="${product.images[0]}" alt="${product.title}">`
                        : 'ðŸ“¦';

                    return `
                        <div class="product-card" onclick="window.location.href='productdetail.html?id=${product.id}'">
                            <div class="product-image">${imageDisplay}</div>
                            <div class="product-info">
                                <div class="product-title">${product.title}</div>
                                <div class="product-price">$${product.price.toFixed(2)}</div>
                                <div class="product-seller">${product.sellerName}</div>
                            </div>
                        </div>
                    `;
                }).join('');

            } catch (error) {
                console.error('Error loading products:', error);
                loading.textContent = 'Error loading products. Please refresh.';
            }
        }

        // Load products when page loads
        loadProducts();
    </script>

    <!-- Search Function -->
    <script>
        function performSearch() {
            const searchTerm = document.getElementById('search-input').value;

            let url = 'search.html?';

            if (searchTerm) {
                url += 'q=' + encodeURIComponent(searchTerm);
            }

            if (!searchTerm) {
                url = 'search.html';
            }

            window.location.href = url;
        }
    </script>
</body>
</html>
